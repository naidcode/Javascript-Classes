<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Habbit-Tracker</title>
  </head>
  <body>
    <h2>Habbit Tracker</h2>
    <br />
    <label for="">Enter Habbit</label>
    <input type="text" placeholder="enter Habbit" id="enterHabbit" />
    <br /><br />
    <button id="addButton">Add habbit</button> <br />
    <ul id="habbitList"></ul>
    <p id="message"></p>
  </body>
  <script>
    let Habbit = JSON.parse(localStorage.getItem("Habbit")) || [];
    document.getElementById("addButton").addEventListener("click", async () => {
      AddHabbit();
    });
    document.body.addEventListener("keypress", async (event) => {
      if (event.key === "Enter") {
        // this is for direct key enter
        AddHabbit();
      }
    });
    function AddHabbit() {
      let enterHabbit = document.getElementById("enterHabbit").value.trim();

      if (!enterHabbit) {
        message(`first enter habbit!`, "red");
        return;
      }
      let habbitList = {
        name: enterHabbit,
        time: new Date().toLocaleTimeString([], {
          hour: "2-digit",
          minute: "2-digit",
          hour12: true,
          second: "2-digit",
        }),
        streak: 0,
        completedToday: false,
      };

      Habbit.push(habbitList);
      document.getElementById("enterHabbit").value = "";
      renderTask();
      updateStorage();
      message("Add habbit!", "green")
    }

    function renderTask() {
      let ul = document.getElementById("habbitList");
      ul.textContent = "";
      Habbit.forEach( (habbitList, index) => {
        let li = document.createElement("li");
        li.textContent = `${habbitList.name} - ${habbitList.time} ${habbitList.streak}`;

         const completeBtn = document.createElement("button");
        completeBtn.textContent =habbitList.completedToday  ? "âœ… Done" : "Complete";
        completeBtn.addEventListener("click", () => completeHabit());

      let deleteButton = document.createElement("button");
      deleteButton.textContent = "Delete";
      deleteButton.style.margin = "10px"
      deleteButton.addEventListener("click" , () => Deleted(index));


      ul.appendChild(li);
      li.appendChild(deleteButton);
        
      })

      }
      let streaks = habbitList.streak;
      function habbitCompelete() {
        if(compLete.textContent === "Completed") {
          streaks++;
        } else {
          compLete.textContent === "incompelete"
        }
      }

      function message(text , color) {
    let msg = document.getElementById("message");
        msg.textContent = text;
        msg.style.color = color;


        setTimeout(() => {
          msg.textContent = "";
        }, 3000);
      }


    function Deleted(index) {
      Habbit.splice(index , 1);
      renderTask();
      updateStorage();
      message("Habbit Deleted!" , "red")
    }

    function updateStorage() {
      localStorage.setItem("Habbit", JSON.stringify(Habbit));
    }
  </script>
</html>
