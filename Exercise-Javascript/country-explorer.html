<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Country Search - Single Result</title>
  <style>
    body{
      font-family:Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height:100vh;
      padding:20px;
      text-align:center;
      margin:0;
    }
    .container{
      max-width:600px;
      margin:40px auto;
    }
    h1{
      color:white;
      margin-bottom:30px;
      font-size:2.5rem;
    }
    .search-box{
      background:white;
      padding:30px;
      border-radius:15px;
      box-shadow:0 10px 30px rgba(0,0,0,0.3);
      margin-bottom:30px;
    }
    .search-input-group{
      display:flex;
      gap:10px;
    }
    #searchInput{
      flex:1;
      padding:15px;
      font-size:16px;
      border:2px solid #e0e0e0;
      border-radius:8px;
      outline:none;
    }
    #searchInput:focus{border-color:#667eea}
    #searchBtn{
      padding:15px 30px;
      background:#667eea;
      color:white;
      border:none;
      border-radius:8px;
      font-size:16px;
      cursor:pointer;
      font-weight:600;
    }
    #searchBtn:hover{background:#5568d3}
    #searchBtn:disabled{background:#ccc;cursor:not-allowed}
    #message{
      margin-top:15px;
      padding:12px;
      border-radius:8px;
      text-align:center;
      font-weight:500;
    }
    .loading{background:#d1ecf1;color:#0c5460}
    .error{background:#f8d7da;color:#721c24}
    .warning{background:#fff3cd;color:#856404}
    #countryDisplay{
      background:white;
      padding:30px;
      border-radius:15px;
      box-shadow:0 10px 30px rgba(0,0,0,0.3);
      display:none;
    }
    #countryDisplay.show{display:block}
    .country-content{
      display:grid;
      grid-template-columns:200px 1fr;
      gap:30px;
      align-items:start;
    }
    .country-flag{
      width:100%;
      border-radius:10px;
      box-shadow:0 5px 15px rgba(0,0,0,0.2);
    }
    .country-details h2{
      color:#333;
      margin-bottom:15px;
      font-size:2rem;
    }
    .country-info{
      display:flex;
      flex-direction:column;
      gap:10px;
      text-align:left;
    }
    .info-row{
      background:#f0f0f0;
      padding:10px 15px;
      border-radius:5px;
      color:#555;
    }
    .info-row strong{color:#333}
    @media (max-width:768px){
      .country-content{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üåç Country Search</h1>
    
    <div class="search-box">
      <div class="search-input-group">
        <input id="searchInput" type="text" placeholder="Enter country name (e.g., India, Japan)">
        <button id="searchBtn">Search</button>
      </div>
      <p id="message"></p>
    </div>

    <div id="countryDisplay"></div>
  </div>

  <script>
    // ==========================================
    // 1. DATA LAYER - Country Class
    // ==========================================
    class Country {
      #name
      #flag
      #population
      #capital
      #region
      #languages
      #currencies

      constructor(countryData) {
        this.#name = countryData.name
        this.#flag = countryData.flag
        this.#population = countryData.population
        this.#capital = countryData.capital
        this.#region = countryData.region
        this.#languages = countryData.languages
        this.#currencies = countryData.currencies
      }

      getName() { return this.#name }
      getFlag() { return this.#flag }
      getPopulation() { return this.#population }
      getCapital() { return this.#capital }
      getRegion() { return this.#region }
      getLanguages() { return this.#languages }
      getCurrencies() { return this.#currencies }
    }

    // ==========================================
    // 2. API LAYER - Fetch ONE Country
    // ==========================================
    async function fetchCountry(countryName) {
      try {
        // Search by country name - returns array but we take first match
        const response = await fetch(`https://restcountries.com/v3.1/name/${encodeURIComponent(countryName)}?fullText=false`)
        
        if (!response.ok) {
          return null
        }
        
        const data = await response.json()
        
        if (!data || data.length === 0) {
          return null
        }

        // Take the first matching country
        const countryData = data[0]

        // Extract languages
        const languages = countryData.languages 
          ? Object.values(countryData.languages).join(', ') 
          : 'N/A'

        // Extract currencies
        const currencies = countryData.currencies
          ? Object.values(countryData.currencies).map(c => c.name).join(', ')
          : 'N/A'

        // Create and return ONE Country object
        return new Country({
          name: countryData.name?.common || 'Unknown',
          flag: countryData.flags?.png || countryData.flags?.svg || '',
          population: countryData.population || 0,
          capital: Array.isArray(countryData.capital) ? countryData.capital[0] : 'N/A',
          region: countryData.region || 'N/A',
          languages: languages,
          currencies: currencies
        })

      } catch (error) {
        console.error('Error fetching country:', error)
        throw error
      }
    }

    // ==========================================
    // 3. UI LAYER - Display Functions
    // ==========================================
    
    function showLoading() {
      const messageEl = document.getElementById('message')
      messageEl.textContent = 'üîç Searching for country...'
      messageEl.className = 'loading'
      hideCountry()
    }

    function showError(errorMessage) {
      const messageEl = document.getElementById('message')
      messageEl.textContent = errorMessage
      messageEl.className = 'error'
      hideCountry()
    }

    function showWarning(warningMessage) {
      const messageEl = document.getElementById('message')
      messageEl.textContent = warningMessage
      messageEl.className = 'warning'
      
      setTimeout(() => {
        clearMessage()
      }, 3000)
    }

    function clearMessage() {
      const messageEl = document.getElementById('message')
      messageEl.textContent = ''
      messageEl.className = ''
    }

    // Display ONE country (No array!)
    function displayCountry(country) {
      const displayEl = document.getElementById('countryDisplay')
      
      const flagUrl = country.getFlag() || 'https://via.placeholder.com/200x150?text=No+Flag'
      
      displayEl.innerHTML = `
        <div class="country-content">
          <div>
            <img src="${flagUrl}" 
                 alt="${country.getName()} flag" 
                 class="country-flag"
                 onerror="this.src='https://via.placeholder.com/200x150?text=No+Flag'">
          </div>
          <div class="country-details">
            <h2>${country.getName()}</h2>
            <div class="country-info">
              <div class="info-row">
                <strong>üèõÔ∏è Capital:</strong> ${country.getCapital()}
              </div>
              <div class="info-row">
                <strong>üë• Population:</strong> ${country.getPopulation().toLocaleString()}
              </div>
              <div class="info-row">
                <strong>üåç Region:</strong> ${country.getRegion()}
              </div>
              <div class="info-row">
                <strong>üí¨ Languages:</strong> ${country.getLanguages()}
              </div>
              <div class="info-row">
                <strong>üí∞ Currencies:</strong> ${country.getCurrencies()}
              </div>
            </div>
          </div>
        </div>
      `
      
      displayEl.classList.add('show')
      clearMessage()
    }

    function hideCountry() {
      const displayEl = document.getElementById('countryDisplay')
      displayEl.classList.remove('show')
    }

    // ==========================================
    // 4. CONTROLLER LAYER - Event Handler
    // ==========================================
    
    const searchInput = document.getElementById('searchInput')
    const searchBtn = document.getElementById('searchBtn')

    async function handleSearch() {
      const searchTerm = searchInput.value.trim()

      if (!searchTerm) {
        showWarning('‚ö†Ô∏è Please enter a country name')
        return
      }

      searchBtn.disabled = true
      showLoading()

      try {
        // Fetch ONE country (no array!)
        const country = await fetchCountry(searchTerm)

        if (!country) {
          showError('‚ùå Country not found. Please try another name.')
        } else {
          // Display that ONE country (no array!)
          displayCountry(country)
        }

      } catch (error) {
        showError('‚ùå Something went wrong. Please try again.')
        console.error('Detailed error:', error)
      } finally {
        searchBtn.disabled = false
      }
    }

    searchBtn.addEventListener('click', ()  => {
      handleSearch()
    })
    
    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleSearch()
      }
    })

    console.log('Country Search App Loaded! Try searching for "India", "Japan", or "Brazil"')
  </script>
</body>
</html>